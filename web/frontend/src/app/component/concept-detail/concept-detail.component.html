<div *ngIf="concept" style="padding-top:3px;">
  <p-panel [showHeader]="false">
    <div class="row">
      <div class="col-8">
        <div class="table-responsive">
          <table class="table table-striped table-bordered">
            <tbody>
              <tr>
                <!-- if there are more of these, make them terminology metadata  -->
                <td *ngIf="terminology == 'ncit'" class="w-20">NCI
                  Thesaurus Code:</td>
                <td *ngIf="terminology == 'ncim'" class="w-20">CUI:
                </td>
                <td *ngIf="terminology != 'ncit' && terminology != 'ncim'" class="w-20">
                  Code:
                </td>
                <td class="w-50">{{ concept.code }}</td>
              </tr>
              <!-- <tr>
              <td *ngIf="getCodeLabel(); else noCodeLabel" class="w-20">{{getCodeLabel()}}: </td>
              <ng-template #noCodeLabel><td class="w-20">Code: </td></ng-template>
              <td class="w-50">{{ concept.code }}</td>
            </tr> -->
              <tr *ngIf="concept.semanticTypes && concept.semanticTypes.length > 0">
                <td class="w-30">Semantic Type(s):</td>
                <td class="w-50"><span *ngFor="let sty of concept.semanticTypes; last as isLast">
                    {{ sty }} <span *ngIf="!isLast"><br /></span>
                  </span></td>
              </tr>
              <tr *ngIf="concept.getPreferredName()">
                <td class="w-30">Preferred Name:</td>
                <td class="w-50">{{ concept.getPreferredName() }}</td>
              </tr>
              <tr *ngIf="concept.getDisplayName()">
                <td class="w-30">Display Name:</td>
                <td class="w-50">{{ concept.getDisplayName() }}</td>
              </tr>
              <tr>
                <td class="w-30">Concept Name:</td>
                <td class="w-50">{{ concept.name }}</td>
              </tr>
              <tr *ngIf="concept.getConceptStatus()">
                <td class="w-30">Concept Status:</td>
                <td class="w-50">{{ concept.getConceptStatus() }}</td>
              </tr>
              <tr *ngIf="conceptIsSubset">
                <td class="w-30">Subset Link:</td>
                <td class="w-50"><a [routerLink]="['/subset', terminology, concept.code]"
                    [target]="_top">{{ concept.code }}</a></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="col-4">
        <div class="table-responsive">
          <table class="table table-striped table-bordered">
            <tbody>
              <tr>
                <td class="link-table-cell"><a class="link-table-entry" title="Scroll To Synonyms"
                    (click)="clickScroll('synonyms')">Synonyms</a></td>
              </tr>
              <tr>
                <td class="link-table-cell"><a class="link-table-entry"
                    title="Scroll To Other Properties" (click)="clickScroll('other')">Other
                    Properties</a></td>
              </tr>
              <tr>
                <td class="link-table-cell"><a class="link-table-entry"
                    title="Scroll To Parent/Child Concepts"
                    (click)="clickScroll('parents')">Parent/Child
                    Concepts</a></td>
              </tr>
              <tr>
                <td *ngIf="!(configService.isMultiSource() && configService.isRrf())"
                  class="link-table-cell"><a class="link-table-entry"
                    title="Scroll To Roles and Associations"
                    (click)="clickScroll('roleRelationships')">Roles and Associations</a>
                </td>
                <td *ngIf="configService.isMultiSource() && configService.isRrf()"
                  class="w-20 link-table-cell"><a class="link-table-entry"
                    title="Scroll To Other Relationships"
                    (click)="clickScroll('otherRelationships')">Other Relationships</a>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

  </p-panel>

  <p-panel [toggleable]="true" [collapsed]="collapsed">
    <p-header class="bold-heading">
      Definitions <a (click)="scrollToTop()" class="top-link">[TOP]</a>
    </p-header>
    <div class="table-responsive">
      <p-table class="table table-striped table-bordered" [value]="concept.definitions"
        sortMode="single"
        *ngIf="concept.definitions && concept.definitions.length > 0;else elseBlockDefinitions"
        (sortFunction)="customSort($event)" [customSort]="true">
        <ng-template pTemplate="header">
          <tr>
            <th class="w-80" [pSortableColumn]="'definition'">Definition
              <p-sortIcon [field]="'definition'"></p-sortIcon>
            </th>
            <th class="w-10" [pSortableColumn]="'source'">Source
              <p-sortIcon [field]="'source'"></p-sortIcon>
            </th>
            <th *ngIf="configService.isRdf() || configService.isSingleSource()" class="w-10">
              Attribution</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-val>
          <ng-container>
            <tr *ngIf="checkFilter(val)">
              <td [innerHtml]="bypassHTML(val.definition)"></td>
              <td [innerHtml]="bypassHTML(val.source)"></td>
              <!-- TODO: NCIt-specific, expand to generally use qualifiers -->
              <td *ngIf="configService.isRdf() || configService.isSingleSource()">
                <span *ngFor="let qual of val.qualifiers">
                  <span *ngIf="qual.type == 'attribution'">{{ qual.value
                    }}</span></span>
              </td>
            </tr>
          </ng-container>
        </ng-template>
      </p-table>
    </div>
    <ng-template #elseBlockDefinitions>None</ng-template>
  </p-panel>
  <br />
  <p-panel [toggleable]="true" [collapsed]="collapsed">
    <p-header class="bold-heading" id="synonyms">
      Synonyms & Abbreviations <a (click)="scrollToTop()" class="top-link">[TOP]</a>
    </p-header>
    <div class="table-responsive">
      <p-table class="table table-striped table-bordered" [value]="concept.synonyms"
        (sortFunction)="customSort($event)" [customSort]="true">
        <ng-template pTemplate="header">
          <tr>
            <th class="w-50" [pSortableColumn]="'name'">Term
              <p-sortIcon [field]="'name'"></p-sortIcon>
            </th>
            <th class="w-10" [pSortableColumn]="'source'">Source
              <p-sortIcon [field]="'source'"></p-sortIcon>
            </th>
            <th class="w-15" [pSortableColumn]="'termType'">Term Type
              <p-sortIcon [field]="'termType'"></p-sortIcon>
            </th>
            <th *ngIf="configService.isMultiSource()" class="w-10" [pSortableColumn]="'code'">Code
              <p-sortIcon [field]="'code'"></p-sortIcon>
            </th>
            <th *ngIf="configService.isMultiSource() && configService.isRdf()" class="w-10"
              [pSortableColumn]="'subSource'">
              Subsource Name
              <p-sortIcon [field]="'subSource'"></p-sortIcon>
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-synonym>
          <!-- Only display the entries that have a termtype -->
          <ng-container>
            <tr *ngIf="checkFilter(synonym)">
              <td>{{ synonym.name }}</td>
              <td>{{ synonym.source }}</td>
              <td><span *ngIf="synonym.termType">{{ synonym.termType }}</span>
                <span *ngIf="!synonym.termType">({{ synonym.type }})</span>
              </td>
              <td *ngIf="configService.isMultiSource()"><a
                  *ngIf="!(configService.isSingleSource() && configService.isRdf()) && synonym.source == 'NCI' && synonym.code"
                  [routerLink]="['/concept/ncit/', synonym.code]" target="_top">{{
                  synonym.code
                  }}</a>
                <a *ngIf="!(configService.isSingleSource() && configService.isRrf()) && synonym.source == 'MDR' && synonym.code"
                  [routerLink]="['/concept/mdr/', synonym.code]" target="_top">{{
                  synonym.code
                  }}</a>
                <a *ngIf="getHierarchy(synonym.source) && synonym.code"
                  [routerLink]="['/hierarchy/', getTerminologyBySource(synonym.source), synonym.code]"
                  target="_top"><i class="pi pi-sitemap" style="font-size: 1.25rem"></i></a>
                <span
                  *ngIf="(synonym.source != 'MDR' && synonym.source != 'NCI') || !synonym.code">{{
                  synonym.code }}
                </span>
              </td>
              <td *ngIf="configService.isMultiSource() && configService.isRdf()">{{
                synonym.subSource }}</td>
            </tr>
          </ng-container>
        </ng-template>
      </p-table>
    </div>
  </p-panel>
  <br />

  <p-panel [toggleable]="true" [collapsed]="collapsed">
    <p-header class="bold-heading" id="other">
      Other Properties <a (click)="scrollToTop()" class="top-link">[TOP]</a>
    </p-header>
    <div class="table-responsive">
      <p-table class="table table-striped table-bordered" [value]="concept.properties"
        (sortFunction)="customSort($event)" [customSort]="true">
        <ng-template pTemplate="header">
          <tr>
            <th class="w-20" [pSortableColumn]="'type'">Type
              <p-sortIcon [field]="'type'"></p-sortIcon>
            </th>
            <th class="w-50" [pSortableColumn]="'value'">Value
              <p-sortIcon [field]="'value'"></p-sortIcon>
            </th>
            <th *ngIf="configService.isMultiSource() && configService.isRrf()"
              class="w-20 link-table-cell" [pSortableColumn]="'source'">Source
              <p-sortIcon [field]="'source'"></p-sortIcon>
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-property>
          <ng-container>
            <tr *ngIf="checkFilter(property)">
              <td>{{property.type}}</td>
              <td>
                <span *ngIf="property.type == 'NCI_META_CUI' || property.type == 'UMLS_CUI'">
                  <a [routerLink]="['/concept/ncim/' + property.value]"
                    target=_top>{{property.value}}</a></span>
                <span
                  *ngIf="!externalLinks[property.type] && property.type != 'NCI_META_CUI' && property.type != 'UMLS_CUI'"
                  [innerHTML]="checkExternalLink(property)"></span>
                <span *ngIf="property.qualifiers && property.qualifiers.length > 0">
                  <span *ngFor="let qual of property.qualifiers">
                    <br />&nbsp;&nbsp;{{ qual.type }} = {{ qual.value }}
                  </span>
                </span>
              </td>
              <td *ngIf="configService.isMultiSource() && configService.isRrf()">
                {{property.source}}
              </td>
            </tr>
          </ng-container>
        </ng-template>
      </p-table>
    </div>
  </p-panel>
  <br />

  <p-panel [toggleable]="true" [collapsed]="collapsed" *ngIf="configService.isRdf()">
    <p-header class="bold-heading">
      Maps To <a (click)="scrollToTop()" class="top-link">[TOP]</a>
    </p-header>
    <div class="table-responsive">
      <p-table class="table table-striped table-bordered" [value]="concept.maps"
        *ngIf="concept.maps && concept.maps.length > 0; else elseBlockMaps"
        (sortFunction)="customSort($event)" [customSort]="true">
        <ng-template pTemplate="header">
          <tr>
            <th class="w-20 link-table-cell" [pSortableColumn]="'targetName'">Target
              Name
              <p-sortIcon [field]="'targetName'"></p-sortIcon>
            </th>
            <th class="w-20" [pSortableColumn]="'type'">Relationship to Target
              <p-sortIcon [field]="'type'"></p-sortIcon>
            </th>
            <th class="w-20" [pSortableColumn]="'targetTermType'">Target Term Type
              <p-sortIcon [field]="'targetTermType'"></p-sortIcon>
            </th>
            <th class="w-10" [pSortableColumn]="'targetCode'">Target Code
              <p-sortIcon [field]="'targetCode'"></p-sortIcon>
            </th>
            <th class="w-20" [pSortableColumn]="'targetTerminology'">Target Terminology
              <p-sortIcon [field]="'targetTerminology'"></p-sortIcon>
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-map>
          <tr>
            <td>{{ map.targetName }}</td>
            <td>{{ map.type }}</td>
            <td>{{ map.targetTermType }}</td>
            <td>{{ map.targetCode }}</td>
            <td>{{ map.targetTerminology }} {{ map.targetTerminologyVersion }}</td>
          </tr>
        </ng-template>
      </p-table>
    </div>
    <ng-template #elseBlockMaps>None</ng-template>

  </p-panel>
  <p-panel [toggleable]="true" [collapsed]="collapsed" *ngIf="configService.isRrf()">
    <p-header class="bold-heading">
      Mappings <a (click)="scrollToTop()" class="top-link">[TOP]</a>
    </p-header>
    <div class="table-responsive">
      <p-table class="table table-striped table-bordered" [value]="concept.maps"
        *ngIf="concept.maps && concept.maps.length > 0; else elseBlockMaps"
        (sortFunction)="customSort($event)" [customSort]="true">
        <ng-template pTemplate="header">
          <tr>
            <th class="w-10" [pSortableColumn]="'sourceCode'">Source Code
              <p-sortIcon [field]="'sourceCode'"></p-sortIcon>
            </th>
            <th class="w-20" [pSortableColumn]="'sourceTerminology'">Source Terminology
              <p-sortIcon [field]="'sourceTerminology'"></p-sortIcon>
            </th>
            <th class="w-20" [pSortableColumn]="'type'">Relationship to Target
              <p-sortIcon [field]="'type'"></p-sortIcon>
            </th>
            <th class="w-10" [pSortableColumn]="'targetCode'">Target Code
              <p-sortIcon [field]="'targetCode'"></p-sortIcon>
            </th>
            <th class="w-20" [pSortableColumn]="'targetTerminology'">Target Terminology
              <p-sortIcon [field]="'targetTerminology'"></p-sortIcon>
            </th>
            <th class="w-20" [pSortableColumn]="'targetName'">Target Name
              <p-sortIcon [field]="'targetName'"></p-sortIcon>
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-map>
          <tr>
            <td>{{ map.sourceCode }}</td>
            <td>{{ map.sourceTerminology }}</td>
            <td>{{ map.type }}</td>
            <td>{{ map.targetCode }}</td>
            <td>{{ map.targetTerminology }} {{ map.targetTerminologyVersion }}</td>
            <td>{{ map.targetName }}</td>
          </tr>
        </ng-template>
      </p-table>
    </div>
    <ng-template #elseBlockMaps>None</ng-template>
  </p-panel>
  <br />
</div>
